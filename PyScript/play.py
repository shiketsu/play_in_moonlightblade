import Layout
from VirtualKeyMouse import *
import random

entries = {
    'C5': (175, 513),
    'D5': (344, 513),
    'E5': (513, 513),
    'F5': (682, 513),
    'G5': (851, 513),
    'A5': (1020, 513),
    'B5': (1192, 513),
    'C4': (175, 582),
    'D4': (344, 582),
    'E4': (513, 582),
    'F4': (682, 582),
    'G4': (851, 582),
    'A4': (1020, 582),
    'B4': (1192, 582),
    'C3': (175, 656),
    'D3': (344, 656),
    'E3': (513, 656),
    'F3': (682, 656),
    'G3': (851, 656),
    'A3': (1020, 656),
    'B3': (1192, 656)
}


def period(t, tempo=480):
    fourth = 60/tempo
    if t == 4:
        return fourth
    if t == 5:  # 附点4分音符
        return fourth + fourth / 2
    elif t == 8:
        return fourth/2
    elif t == 16:
        return fourth/4
    elif t == 2:
        return 2*fourth
    elif t == 3:  # 附点2分音符
        return 3*fourth
    elif t == 1:
        return 4*fourth
    elif t == 9:  # 附点9分音符
        return fourth/2 + fourth/4
    elif t == 17:
        return fourth/4 + fourth / 8
    elif t == 32:
        return fourth/8


def play(music, tempo=80):
    for item in music:
        note, t = item
        print(item)
        if t < 0:
            mouse_click_point(entries[note], -t*period(4, tempo))
        elif note != 'R':  # not rest
            mouse_click_point(entries[note])
            time.sleep(period(t, tempo))
        else:
            time.sleep(period(t, tempo))


if __name__ == "__main__":
    Layout.setup_app(0, 0, 1280, 720)

# senbonzakura
music_senbonzakura = [
    # 1
    ('G4', 8), ('A4', 8), ('D4', 16), ('C4', 16), ('D4', 16), ('C4', 16),
    ('G4', 8), ('A4', 8), ('D4', 16), ('C4', 16), ('D4', 16), ('C4', 16),
    ('G4', 8), ('A4', 8), ('D4', 16), ('C4', 16), ('D4', 16), ('C4', 16),
    ('F4', 8), ('E4', 8), ('F4', 32), ('E4', 32), ('D4', 16), ('C4', 8),
    ('G4', 8), ('A4', 8), ('D4', 16), ('C4', 16), ('D4', 16), ('C4', 16),
    ('G4', 8), ('A4', 8), ('D4', 16), ('C4', 16), ('D4', 16), ('C4', 16),
    ('G4', 8), ('A4', 8), ('C5', 8), ('F5', 8),
    ('E5', 16), ('F5', 16), ('E5', 16), ('D5', 16), ('C5', 8), ('A4', 8),
    # 2
    ('G4', 8), ('A4', 8), ('D4', 16), ('C4', 16), ('D4', 16), ('C4', 16),
    ('G4', 8), ('A4', 8), ('D4', 16), ('C4', 16), ('D4', 16), ('C4', 16),
    ('G4', 8), ('A4', 8), ('D4', 16), ('C4', 16), ('D4', 16), ('C4', 16),
    ('F4', 8), ('E4', 8), ('F4', 32), ('E4', 32), ('D4', 16), ('C4', 8),
    ('D4', 8), ('C4', 16), ('D4', 16), ('F4', 8), ('D4', 16), ('F4', 16),
    ('A4', 8), ('G4', 16), ('A4', 16), ('C5', 8), ('A4', 16), ('C5', 16),
    ('F5', 8), ('E5', 16), ('F5', 32), ('E5', 32), ('D5', 8), ('C5', 8),
    ('D5', 4), ('D4', 8), ('F4', 8),
    # 3
    ('G4', 8), ('A4', 8), ('D4', 16), ('C4', 16), ('D4', 16), ('C4', 16),
    ('G4', 8), ('A4', 8), ('D4', 16), ('C4', 16), ('D4', 16), ('C4', 16),
    ('G4', 8), ('A4', 8), ('D4', 16), ('C4', 16), ('D4', 16), ('C4', 16),
    ('F4', 8), ('E4', 8), ('F4', 32), ('E4', 32), ('D4', 16), ('C4', 8),
    ('G4', 8), ('A4', 8), ('D4', 16), ('C4', 16), ('D4', 16), ('C4', 16),
    ('G4', 8), ('A4', 8), ('D4', 16), ('C4', 16), ('D4', 16), ('C4', 16),
    ('G4', 8), ('A4', 8), ('C5', 8), ('F5', 8),
    ('E5', 16), ('F5', 16), ('E5', 16), ('D5', 16), ('C5', 8), ('A4', 8),
    # 4
    ('G4', 8), ('A4', 8), ('D4', 16), ('C4', 16), ('D4', 16), ('C4', 16),
    ('G4', 8), ('A4', 8), ('D4', 16), ('C4', 16), ('D4', 16), ('C4', 16),
    ('G4', 8), ('A4', 8), ('D4', 16), ('C4', 16), ('D4', 16), ('C4', 16),
    ('F4', 8), ('E4', 8), ('F4', 32), ('E4', 32), ('D4', 16), ('C4', 8),
    ('G4', 16), ('F4', 16), ('A4', 16), ('C5',
                                         16), ('D5', 16), ('C5', 16), ('A4', 16), ('G4', 16),
    ('D4', 9), ('F4', 16), ('G4', 8), ('A4', 8),
    ('D4', 8), ('D4', 16), ('D4', 16), ('R', 8), ('C4', 8),
    ('D4', 4), ('R', 4),
    # 5
    ('D4', 9), ('D4', 16), ('D4', 8), ('C4', 8),
    ('D4', 8), ('F4', 8), ('F4', 8), ('G4', 8),
    ('D4', 9), ('D4', 16), ('D4', 8), ('C4', 8),
    ('D4', 8), ('C4', 8), ('A3', 8), ('C4', 8),
    ('D4', 9), ('D4', 16), ('D4', 8), ('C4', 8),
    ('D4', 8), ('F4', 8), ('F4', 8), ('G4', 8),
    ('A4', 4), ('A4', 8), ('A4', 16), ('G4', 16),
    ('F4', 4), ('D4', 4),
    # 6
    ('D4', 9), ('D4', 16), ('D4', 8), ('C4', 8),
    ('D4', 8), ('F4', 8), ('F4', 8), ('G4', 8),
    ('D4', 9), ('D4', 16), ('D4', 8), ('C4', 8),
    ('D4', 8), ('C4', 8), ('C4', 8), ('A3', 8),
    ('D4', 9), ('D4', 16), ('D4', 8), ('C4', 8),
    ('D4', 8), ('F4', 8), ('F4', 8), ('G4', 8),
    ('A4', 4), ('A4', 8), ('A4', 16), ('G4', 16),
    ('F4', 4), ('D4', 4),
    # 7
    ('F4', 4), ('E4', 4), ('D4', 4), ('C4', 4),
    ('C4', 8), ('C4', 16), ('D4', 16), ('A3', 8), ('G3', 8),
    ('A3', 2),
    ('A3', 8), ('C4', 4), ('D4', 8), ('G4', 4), ('E4', 4),
    ('F4', 9), ('F4', 16), ('E4', 8), ('C4', 8), ('D4', 2),
    # 8
    ('F4', 4), ('E4', 4), ('D4', 4), ('C4', 4),
    ('C4', 8), ('C4', 16), ('D4', 16), ('A3', 8), ('G3', 8),
    ('A3', 4), ('A3', 8), ('C4', 8),
    ('D4', 8), ('D4', 4), ('D4', 8), ('F4', 4), ('G4', 4),
    ('E4', 3), ('D4', 8), ('F4', 8),
    # 9
    ('G4', 8), ('G4', 16), ('G4', 16), ('G4', 8), ('A4', 8),
    ('A4', 5), ('A4', 8),
    ('C5', 8), ('D5', 8), ('G4', 8), ('F4', 8),
    ('A4', 4), ('D4', 8), ('F4', 8),
    ('G4', 8), ('G4', 16), ('G4', 16), ('G4', 8), ('A4', 8),
    ('A4', 5), ('A4', 8),
    ('B4', 8), ('A4', 8), ('G4', 8), ('F4', 8),
    ('F4', 4), ('D4', 8), ('F4', 8),
    # 10
    ('G4', 8), ('G4', 16), ('G4', 16), ('G4', 8), ('A4', 8),
    ('A4', 5), ('A4', 8),
    ('C5', 8), ('D5', 8), ('G4', 8), ('F4', 8),
    ('A4', 4), ('D4', 8), ('F4', 8),
    ('B4', 4), ('A4', 4), ('G4', 4), ('F4', 4),
    #('G4', 8), ('A4', 8), ('F4', 8), ('C4', 8),
    #('D4', 4), ('D4', 8), ('F4', 8),
    # 9
    ('G4', 8), ('G4', 16), ('G4', 16), ('G4', 8), ('A4', 8),
    ('A4', 5), ('A4', 8),
    ('C5', 8), ('D5', 8), ('G4', 8), ('F4', 8),
    ('A4', 4), ('D4', 8), ('F4', 8),
    ('G4', 8), ('G4', 16), ('G4', 16), ('G4', 8), ('A4', 8),
    ('A4', 5), ('A4', 8),
    ('B4', 8), ('A4', 8), ('G4', 8), ('F4', 8),
    ('F4', 4), ('D4', 8), ('F4', 8),
    # 10
    ('G4', 8), ('G4', 16), ('G4', 16), ('G4', 8), ('A4', 8),
    ('A4', 5), ('A4', 8),
    ('C5', 8), ('D5', 8), ('G4', 8), ('F4', 8),
    ('A4', 4), ('D4', 8), ('F4', 8),
    ('B4', 4), ('A4', 4), ('G4', 4), ('F4', 4),
    ('G4', 8), ('A4', 8), ('F4', 8), ('C4', 8),
    ('D4', 4), ('D4', 8), ('F4', 8),
    # 11
    ('G4', 8), ('F4', 8), ('A4', 8), ('C5', 8),
    ('D5', 4), ('R', 4), ('R', 1), ('R', 1), ('R', 1),
    # 12
    ('F4', 4), ('E4', 4), ('D4', 4), ('C4', 4),
    ('C4', 8), ('C4', 16), ('D4', 16), ('A3', 16), ('G3', 16),
    ('A3', 2),
    ('A3', 8), ('C4', 4), ('D4', 8), ('G4', 4), ('E4', 4),
    ('F4', 9), ('F4', 16), ('E4', 8), ('C4', 8), ('D4', 2),
    # 13
    ('F4', 4), ('E4', 4), ('D4', 4), ('C4', 4),
    ('C4', 8), ('C4', 16), ('D4', 16), ('A3', 16), ('G3', 16),
    ('A3', 4), ('A3', 8), ('C4', 8),
    ('D4', 8), ('D4', 4), ('D4', 8), ('F4', 4), ('G4', 4),
    ('E4', 3), ('D4', 8), ('F4', 8),
    # 14
    ('G4', 8), ('G4', 16), ('G4', 16), ('G4', 8), ('A4', 8),
    ('A4', 5), ('A4', 8),
    ('C5', 8), ('D5', 8), ('G4', 8), ('F4', 8),
    ('A4', 4), ('D4', 8), ('F4', 8),
    ('G4', 8), ('G4', 16), ('G4', 16), ('G4', 8), ('A4', 8),
    ('A4', 5), ('A4', 8),
    ('B4', 8), ('A4', 8), ('G4', 8), ('F4', 8),
    ('F4', 4), ('D4', 8), ('F4', 8),
    # 15
    ('G4', 8), ('G4', 16), ('G4', 16), ('G4', 8), ('A4', 8),
    ('A4', 5), ('A4', 8),
    ('C5', 8), ('D5', 8), ('G4', 8), ('F4', 8),
    ('A4', 4), ('D4', 8), ('F4', 8),
    ('B4', 4), ('A4', 4), ('G4', 4), ('F4', 4),
    ('G4', 8), ('A4', 8), ('G4', 8), ('A4', 8),
    ('A4', 4), ('E4', 8), ('G4', 8),
    # 16
    ('A4', 8), ('A4', 16), ('A4', 16), ('A4', 8), ('B4', 8),
    ('B4', 5), ('B4', 8),
    ('D5', 8), ('E5', 8), ('A4', 8), ('G4', 8),
    ('B4', 4), ('E4', 8), ('G4', 8),
    ('A4', 8), ('A4', 16), ('A4', 16), ('A4', 8), ('B4', 8),
    ('B4', 5), ('B4', 8),
    ('C5', 8), ('B4', 8), ('A4', 8), ('G4', 8),
    ('G4', 4), ('E4', 8), ('G4', 8),
    # 17
    ('A4', 8), ('A4', 16), ('A4', 16), ('A4', 8), ('B4', 8),
    ('B4', 5), ('B4', 8),
    ('D5', 8), ('E5', 8), ('A4', 8), ('G4', 8),
    ('B4', 4), ('E4', 8), ('G4', 8),
    ('C5', 4), ('B4', 4), ('A4', 4), ('G4', 4),
    ('A4', 8), ('G4', 8), ('B4', 8), ('D5', 8),
    ('E5', 2)
]

# while True:
# mouse_click_point((1100, 50))  # 开始录制
# time.sleep(0.2)
# play(music_xinyueshenhua, tempo=120)
# play(music_huimengyouxian, tempo=80)
play(music_senbonzakura, tempo=340)
# time.sleep(5)
